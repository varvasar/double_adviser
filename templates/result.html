<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LLM LAN Receiver</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin: 24px; }
      pre { background:#f6f6f8; padding:12px; border-radius:8px; white-space:pre-wrap }
      .meta { color:#666; font-size:14px }
    </style>
  </head>
  <body>
    <h1>LLM Result</h1>
    <div class="meta">Last update: {% if result.timestamp %}{{ result.timestamp | int }}{% else %}never{% endif %} | raw: {{ result.raw }}</div>
    <h2>AI Output</h2>
    <pre>{{ result.text }}</pre>

    <script>
      // Poll for updates every 2.5s
      setInterval(()=>fetch(location.href).then(r=>r.text()).then(html=>{
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const pre = doc.querySelector('pre');
        if(pre){ document.querySelector('pre').innerHTML = pre.innerHTML }
        const meta = doc.querySelector('.meta');
        if(meta){ document.querySelector('.meta').innerHTML = meta.innerHTML }
      }), console.warn)
    </script>
  </body>
</html>
